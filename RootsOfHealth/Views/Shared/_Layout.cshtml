<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,900" rel="stylesheet">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/css/bootstrap-select.css" />

    <link href="https://cdn.rawgit.com/atatanasov/gijgo/master/dist/combined/css/gijgo.min.css" rel="stylesheet" type="text/css" />

    <link rel="stylesheet" href="https://code.jquery.com/qunit/qunit-1.11.0.css" type="text/css" media="all">

    <!-- CSS for Calenders -->


    <link href="~/css/fullcalendar.min.css" rel="stylesheet" />
    <link href="~/css/select2.min.css" rel="stylesheet" />
    <!-- Font Awesome CSS start here -->

    <link href="~/css/all.min.css" rel="stylesheet" />
    <!-- Bootstrap CSS start here  -->
    <link href="~/css/bootstrap.min.css" rel="stylesheet" />
    <link href="~/css/style.css" rel="stylesheet" media="print,all,screen" />
    <!-- Responsive CSS start here  -->

    <link href="~/css/responsive.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.3/toastr.min.css" integrity="sha512-6S2HWzVFxruDlZxI3sXOZZ4/eJ8AcxkQH1+JjSe/ONCEqR9L4Ysq5JdT5ipqtzU7WHalNwzwBv+iE51gNHJNqQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    @*<link href="~/css/toastr.min.css" rel="stylesheet" />*@
    <title>Welcome to Roots Community Health Center </title>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.15/datatables.min.css" />
    <link href="https://code.jquery.com/ui/1.12.1/themes/ui-lightness/jquery-ui.css"
          rel="stylesheet">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.css">
    <!-- Custom CSS start here  -->
    @Scripts.Render("~/bundles/modernizr")
    @Scripts.Render("~/bundles/jquery")
    @using RootsOfHealth.Commom;
    @{

        var modulePermissions = new Common().GetMainModulesPermission(Convert.ToInt32(Session["userid"]));
    }



    <style>
        .loaderOverlay {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 99999;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(255,255,255,0.95);
            display: none;
        }

        .loader {
            width: 100px;
            height: 100px;
            border-radius: 100%;
            position: relative;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #loader-6 {
        }

            #loader-6 span {
                display: inline-block;
                width: 5px;
                height: 20px;
                background-color: #22baa0;
                margin-right: 2px;
            }

                #loader-6 span:nth-child(1) {
                    animation: grow 1s ease-in-out infinite;
                }

                #loader-6 span:nth-child(2) {
                    animation: grow 1s ease-in-out 0.15s infinite;
                }

                #loader-6 span:nth-child(3) {
                    animation: grow 1s ease-in-out 0.30s infinite;
                }

                #loader-6 span:nth-child(4) {
                    animation: grow 1s ease-in-out 0.45s infinite;
                }

        @@keyframes grow {
            0%, 100% {
                -webkit-transform: scaleY(1);
                -ms-transform: scaleY(1);
                -o-transform: scaleY(1);
                transform: scaleY(1);
            }

            50% {
                -webkit-transform: scaleY(1.8);
                -ms-transform: scaleY(1.8);
                -o-transform: scaleY(1.8);
                transform: scaleY(1.8);
            }
        }

        .rounded_tabs_list .nav-tabs,
        #content .profile-tabs .rounded_tabs_list .nav-tabs {
            border: 0;
            margin: 0 0 10px;
            position: static;
            background: transparent;
            padding: 0;
            height: auto;
            overflow: visible;
        }

            .rounded_tabs_list .nav-tabs li a {
                border: none;
                font-style: normal;
                font-weight: normal;
                font-size: 14px;
                line-height: 16px;
                display: flex;
                align-items: center;
                text-align: center;
                color: #818181;
                padding: 10px 15px;
                border-radius: 50px;
                position: relative;
                background: transparent;
                text-transform: uppercase;
                height: auto;
            }

            .rounded_tabs_list .nav-tabs li {
                margin: 0;
            }

                .rounded_tabs_list .nav-tabs li a:after {
                    display: none;
                }

            .rounded_tabs_list .nav-tabs .nav-link.active {
                background: #FFFFFF !important;
                box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.25) !important;
                font-weight: 500;
                color: #555;
                width: auto;
            }

        .rounded_tabs_list .tab-content .tab-pane {
            padding-top: 15px;
        }

        div#formSharingModal {
            padding: 0 !important;
        }

            div#formSharingModal .modal-dialog {
                width: 100%;
                max-width: 1100px !important;
                min-height: initial;
            }

                div#formSharingModal .modal-dialog .modal-content {
                    min-height: 552px;
                }

        h6.t_filter_head {
            text-align: right;
            padding: 35px 0 0;
            margin: 0;
        }

        a#ShareForm.disabled {
            background: #a1a1a1;
            border-color: #a1a1a1;
        }

        div#formSharingModal .tab-content {
            min-height: initial;
        }

        .members_list_table th {
            color: #999;
            font-weight: normal;
            vertical-align: middle;
        }

        .members_list_table td {
            vertical-align: middle;
        }

        .members_list_table thead th:first-child {
            width: 90px;
        }

        .members_list_table thead th:nth-child(2) {
            width: 30%;
        }

        .dataTables_scrollBody > table > thead > tr {
            visibility: collapse;
            height: 0px !important;
        }

        div#selectDateAndShare {
            z-index: 9999;
            background: rgba(0,0,0,0.5);
        }

        .ui-state-active, .ui-widget-content .ui-state-active, .ui-widget-header .ui-state-active, .ui-state-active.ui-button:hover {
            border: 1px solid #22baa0;
            background: #22baa0;
        }

        #formSharingModal .dataTables_scrollHead table thead {
            background: rgba(0,0,0,.075);
        }

        #formSharingModal .dataTables_scrollHead label.input_checkbox span {
            background: #eee;
        }

        #formSharingModal .bootstrap-select .bs-ok-default.check-mark {
            display: none !important;
        }

        #formSharingModal .searchbox .searchboxDropDown .scroll {
            max-height: 230px;
            overflow: auto;
        }

        .copyLinkText {
            text-align: right;
            padding: 0 0 10px 0;
            font-size: 14px;
        }
    </style>

    <style>
        #Programs .nav-tabs {
            border-bottom: none;
        }

        .colorPrint {
            background: white !important;
            padding-top: 30px !important
        }

        #Programs .nav-tabs:hover {
            overflow-x: hidden !important;
        }

        [draggable] {
            -moz-user-select: none;
            -khtml-user-select: none;
            -webkit-user-select: none;
            user-select: none;
            /* Required to make elements draggable in old WebKit */
            -khtml-user-drag: element;
            -webkit-user-drag: element;
        }

        #columns {
            list-style-type: none;
        }

        .column {
            width: 100%;
            padding-bottom: 5px;
            padding-top: 5px;
            cursor: move;
        }

            .column header {
                height: 20px;
                width: 150px;
                color: black;
                background-color: #ccc;
                padding: 5px;
                border-bottom: 1px solid #ddd;
                border-radius: 10px;
                border: 2px solid #666666;
            }

            .column.dragElem {
                opacity: 0.4;
            }

            .column.over {
                //border: 2px dashed #000;
                border-top: 2px solid blue;
            }

        .render-basicProgramform {
            width: 100%;
            display: flex !important;
            align-items: flex-start;
            flex-wrap: wrap;
            padding: 0;
            box-sizing: border-box;
            align-content: baseline;
            /*max-height: 500px;*/
        }

            .render-basicProgramform .basecontentarea {
                width: 100%;
                display: flex;
                align-items: flex-start;
                flex-wrap: wrap;
                align-content: baseline;
                border: none;
                min-height: unset;
                padding: 0px;
            }

            .render-basicProgramform .form-control {
                height: 50px;
                font-size: 13px;
                border: 1px solid #e2e2e2;
                border-radius: 0px;
                padding: 0 15px;
            }

            .render-basicProgramform select {
                height: 23px !important;
            }

            .render-basicProgramform .priority {
                height: auto !important
            }

            .render-basicProgramform .form-control[type="file"] {
                border: 0;
                padding: 0;
                height: auto;
            }

            .render-basicProgramform textarea.form-control {
                height: 50px;
            }

            .render-basicProgramform .form-control:focus {
                box-shadow: none;
                outline: none;
            }

            .render-basicProgramform .event-btn-right {
                position: absolute;
                bottom: auto;
                right: -1px;
                z-index: 9;
                top: -3px;
            }

            .render-basicProgramform .frmbtn .form-group label:first-child {
                background: #f0f0f0;
                display: block;
                margin: -11px -11px 10px;
                padding: 4px 10px;
                font-size: 14px;
                color: #343434;
                font-weight: 500;
                line-height: normal;
                vertical-align: middle;
            }

            .render-basicProgramform .frmbtn .form-group {
                margin: 0;
            }

            .render-basicProgramform .frmbtn {
                border: 1px solid #e2e2e2;
                padding: 10px;
                position: relative;
                margin: 0 0 10px 0;
            }

                .render-basicProgramform .frmbtn select.form-control {
                    padding: 0 15px;
                    background: url(../images/chevron-arrow-down.svg) no-repeat 0 0;
                    -webkit-appearance: none;
                    -moz-appearance: none;
                    -ms-appearance: none;
                    background-size: 12px;
                    background-position: 98% 5px;
                }

            .render-basicProgramform .data-frmbtn {
                margin: 0 0 0px 0;
            }



            .render-basicProgramform .form-row-first {
                border: 1px solid #e2e2e2;
                background: #fff;
                margin-top: 17px;
            }

                .render-basicProgramform.form-row-first .top-form-row {
                    background: #f0f0f0;
                    padding: 0 10px;
                    border-bottom: 1px solid #e2e2e2;
                    height: auto;
                }

                .render-basicProgramform .form-row-first .one-columns {
                    width: 100%;
                    padding: 0px 5px;
                }

            .render-basicProgramform .bootom-form-row {
                padding: 7px 10px;
            }

            .render-basicProgramform .form-row-first .top-form-row label {
                font-size: 14px;
                color: #343434;
                font-weight: 500;
                margin: 0;
                line-height: normal;
                vertical-align: middle;
            }

            .render-basicProgramform .frmbtn .form-group label span.desc {
                display: block;
                margin: 3px 0 0;
                color: #777;
                font-weight: normal;
            }

            .render-basicProgramform .frmbtn .form-group label.label-left {
                max-width: 50%;
                flex: 0 0 50%;
                margin-right: 0 !important;
                padding-left: 0;
            }

            .render-basicProgramform .frmbtn .form-group.f-g-left {
                align-items: flex-start;
            }

                .render-basicProgramform .frmbtn .form-group.f-g-left .inputContent {
                    max-width: 50%;
                    flex: 0 0 50%;
                }

            .render-basicProgramform label.database-field {
                display: inline-block;
                padding: 0 15px;
            }

        .scroll {
            overflow-y: auto;
        }

        @@page {
            margin: 20mm
        }

        @@media print {

            .left-control .frmbtn {
                border: 0;
                padding: 0;
            }

            .render-basicProgramform .basecontentarea, .render-basicProgramform {
                display: block !important;
                box-sizing: border-box !important;
            }

            table {
                break-inside: auto;
            }

            .dragresize {
                break-inside: avoid;
                padding-top: 10px;
                float: left;
            }

                .dragresize.col-md-6 {
                    width: 50% !important;
                    box-sizing: border-box !important;
                }

                .dragresize.col-md-4 {
                    width: 33.333% !important;
                    box-sizing: border-box !important;
                }

                    .dragresize.col-md-6 div,
                    .dragresize.col-md-4 div {
                        box-sizing: border-box !important;
                    }

            .render-basicProgramform .frmbtn {
                margin: 0px 0 0px 0;
            }
        }

        .careplan-icon, .program-icon, .group-icon {
            display: block;
            width: 27px;
            height: 24px;
            background: url(../../images/care-plans.png) no-repeat -44px -2px;
            margin: auto;
            margin-bottom: 4px;
        }

        .program-icon {
            background: url(../../images/programs.png) no-repeat -45px -2px;
        }

        .group-icon {
            background: url(../../images/user-group.png) no-repeat -43px -2px;
        }

        .sidebar-menu ul a:hover .careplan-icon {
            background-position: -0px -2px;
        }

        .sidebar-menu ul a:hover .program-icon {
            background-position: -2px -2px;
        }

        .sidebar-menu ul a:hover .group-icon {
            background-position: -1px -2px;
        }

        .sidebar-menu ul a span.fas {
            font-size: 22px;
            display: block;
            width: 27px;
            height: 24px;
            margin: auto;
            margin-bottom: 4px;
        }

        body .dataTables_scrollHead table.c_table tr th {
            color: #212529;
            text-transform: uppercase;
        }

        body .dataTables_scrollHead {
            background: rgba(0,0,0,.075) !important;
        }

        /* #droppable .dragresize,
        .dragresize {
            position: static !important;
            width: auto !important;
            height: auto !important;
            font-size: initial !important;
        }*/
        .a_p_basic_no_buttons.render-basicform {
            max-height: calc(100vh - 180px);
        }

        .member_name {
            display: flex;
            align-items: center;
        }

        .member_img {
            height: 40px;
            width: 40px;
            min-width: 40px;
            margin-right: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: #eee;
            overflow: hidden;
        }

            .member_img img {
                height: 100%;
                width: 100%;
                object-fit: contain;
            }

        .member_name_text {
            line-height: 1.3;
        }

            .member_name_text strong {
                display: block;
                font-weight: 500;
            }

            .member_name_text span {
                font-size: 12px;
            }

        label.input_checkbox {
            margin: 0px 0 0;
            position: relative;
            top: 3px;
        }

            label.input_checkbox input {
                position: absolute;
                opacity: 0;
            }

            label.input_checkbox span {
                display: block;
                position: relative;
                height: 20px;
                width: 20px;
                background: #ddd;
                border-radius: 4px;
                cursor: pointer;
            }

            label.input_checkbox input:checked + span,
            #formSharingModal .dataTables_scrollHead label.input_checkbox input:checked + span {
                background-color: #22baa0;
                background-image: url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3E%3Cpath fill='%23fff' d='M6.564.75l-3.59 3.612-1.538-1.55L0 4.26 2.974 7.25 8 2.193z'/%3E%3C/svg%3E");
                background-size: 12px;
                background-repeat: no-repeat;
                background-position: center;
            }


        #ShareformUserList {
            vertical-align: middle;
            font-size: 14px;
            border-bottom: 0 !important;
        }

            #ShareformUserList th, #ShareformUserList td {
                vertical-align: middle !important;
                padding: 10px 18px !important;
            }

            #ShareformUserList tbody tr:first-child td {
                border-top: 0;
            }

            #ShareformUserList thead {
                position: relative;
                z-index: 1;
                background: #f3f4f4;
                border: 0;
                border-radius: 4px;
            }

                #ShareformUserList thead th {
                    border-bottom: 0 !important;
                }

        table#ShareformUserList {
            border: 0;
        }

        .dataTables_scrollBody table#ShareformUserList thead {
            display: none;
        }

        .dataTables_scrollHead .dataTables_scrollBody th {
            color: #212529;
        }

        .rounded_tabs_list {
            padding: 15px 0 0;
        }

        #FormsSharinigNavItem a {
            cursor: pointer;
        }

        .NoFormSelectedMessage {
            border: 1px dashed #ddd;
            text-align: center;
            padding: 20px;
        }

        #ddClientlistforsharing, #FormShareExpirydate, #ddFormNameShareHistory, #ddStatusShareHistory, #selectClientTab, #sharedStatusTab {
            display: block !important
        }


        #formSharingModal .searchbox > button {
            border: none;
            background: none;
            cursor: pointer;
            margin-left: 6px;
            margin-right: 5px;
        }

            #formSharingModal .searchbox > button i {
                font-size: 16px;
                color: #7a7f8c;
            }

        #formSharingModal .searchbox > input {
            padding-left: 14px;
            border: none;
            border-left: 1px solid #dee2e8;
            font-size: 14px;
            color: #a9aaab;
            max-width: calc(100% - 53px);
            flex: 0 0 calc(100% - 53px);
            width: 100%;
        }

        #formSharingModal .searchbox {
            width: 100%;
            max-width: 100%;
            position: relative;
            justify-content: flex-start;
            border: 1px solid #dee2e8;
            padding: 5px 0;
        }

            #formSharingModal .searchbox .searchboxDropDown {
                width: 100%;
                z-index: 99;
                top: 37px;
                left: 0;
                max-height: 300px;
                height: auto;
            }

        .formsharesearchbtn {
            cursor: default;
            pointer-events: none
        }

        #ddClientlistforsharing:focus {
            color: #a9aaab !important;
        }

        #ddClientlistforsharing {
            color: #495057 !important
        }

        #SharedFormExport {
            cursor: pointer;
        }

        #sharedStatusTab .table tr th {
            padding: 10px 10px;
        }

        div#downloadingFormShare .modal-content .close {
            position: absolute;
            right: 15px;
            top: 5px;
            text-shadow: none;
            z-index: 9;
        }

        div#downloadingFormShare .modal-body {
            text-align: center;
        }

        .downoadingModalContent img {
            display: block;
            max-width: 40px;
            margin: 0 auto 0px;
            object-fit: contain;
        }

        .d_m_icon {
            height: 80px;
            width: 80px;
            /* border: 1px solid #ddd; */
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50px;
            margin: 0 auto 15px;
            box-shadow: 0 0 30px rgb(0 0 0 / 16%);
        }

        .downoadingModalContent {
            padding: 15px 0;
        }

        .downloadCompleteText i {
            margin: 0 5px 0 0;
            color: green;
            font-size: 23px;
            position: relative;
            top: 2px;
        }
    </style>
</head>
<body>
    <div class="loaderOverlay">
        <div class="loader" id="loader-6">
            <span></span>
            <span></span>
            <span></span>
            <span></span>
        </div>
    </div>
    @using (Html.BeginForm("DownloadExportFile", "Client", FormMethod.Post, new { @id = "ExportSharedForms_Export" }))
    {
        <input type="hidden" name="clinicId" id="exportClinicId" value="Session[" ClinicID"]" />
    }

    @*<div class="scroll">*@
    <div>
        <!-- Header start here  -->
        <header class="page-header">
            <nav class="navbar navbar-expand-lg fixed-top">
                <div class="header-left d-flex">
                    <a href="#" class="nav-menu1"><img src="~/images/nav-icon.png" /></a>

                </div>

                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav ml-auto">
                        <div class="header-right d-flex">
                            <div class="searchbox">
                                <button type="submit"><i class="fas fa-search"></i></button>
                                <input type="text" placeholder="Search..." id="searchPatient" onkeyup="SearchPatient()" autocomplete="off">

                                <div class="searchboxDropDown">
                                    <div class="scroll">
                                        <ul id="patientList">
                                            <li>
                                                <div class="imagebox">
                                                    <img src="~/images/recent-paitent-img.png" alt="">
                                                </div>
                                                <div class="searchDeatails">
                                                    <span>Name: John</span>
                                                    <span>Email: John@gmail.com</span>
                                                    <span>SSN: 45896325</span>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="imagebox">
                                                    <img src="~/images/recent-paitent-img.png" alt="">
                                                </div>
                                                <div class="searchDeatails">
                                                    <span>Name: John</span>
                                                    <span>Email: John@gmail.com</span>
                                                    <span>SSN: 45896325</span>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="imagebox">
                                                    <img src="~/images/recent-paitent-img.png" alt="">
                                                </div>
                                                <div class="searchDeatails">
                                                    <span>Name: John</span>
                                                    <span>Email: John@gmail.com</span>
                                                    <span>SSN: 45896325</span>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="imagebox">
                                                    <img src="~/images/recent-paitent-img.png" alt="">
                                                </div>
                                                <div class="searchDeatails">
                                                    <span>Name: John</span>
                                                    <span>Email: John@gmail.com</span>
                                                    <span>SSN: 45896325</span>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="imagebox">
                                                    <img src="~/images/recent-paitent-img.png" alt="">
                                                </div>
                                                <div class="searchDeatails">
                                                    <span>Name: John</span>
                                                    <span>Email: John@gmail.com</span>
                                                    <span>SSN: 45896325</span>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="imagebox">
                                                    <img src="~/images/recent-paitent-img.png" alt="">
                                                </div>
                                                <div class="searchDeatails">
                                                    <span>Name: John</span>
                                                    <span>Email: John@gmail.com</span>
                                                    <span>SSN: 45896325</span>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="nav-item dropdown">

                                <a class="notification" id="dropdownMenuButton" data-toggle="dropdown"
                                   aria-haspopup="true" aria-expanded="false">
                                    <i class="far fa-bell"></i><span>5</span>
                                </a>

                                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                    <div class="notification-header d-flex">
                                        <h5>Notification </h5> <a href="#!" class="view-all">Clear All</a>
                                    </div>
                                    <div class="notification-body">
                                        <div class="scroll">
                                            <a class="dropdown-item" href="#">
                                                <span href="#!" class="close"><i class="fas fa-times"></i></span>
                                                <img src="~/images/recent-paitent-img.png" alt="">
                                                <span class="noti-text">
                                                    <h6>Crestina pride</h6>
                                                    <p>Sed ut perspiciatis unde omnis iste natus error sit </p>
                                                </span>
                                            </a>
                                            <a class="dropdown-item" href="#">
                                                <img src="~/images/recent-paitent-img-1.png" alt="">
                                                <span class="noti-text">
                                                    <h6>Crestina pride</h6>
                                                    <p>Sed ut perspiciatis unde omnis iste natus error sit </p>
                                                </span>
                                            </a>
                                            <a class="dropdown-item" href="#">
                                                <img src="~/images/recent-paitent-img-2.png" alt="">
                                                <span class="noti-text">
                                                    <h6>Crestina pride</h6>
                                                    <p>Sed ut perspiciatis unde omnis iste natus error sit </p>
                                                </span>
                                            </a>
                                            <a class="dropdown-item" href="#">
                                                <img src="~/images/recent-paitent-img-2.png" alt="">
                                                <span class="noti-text">
                                                    <h6>Crestina pride</h6>
                                                    <p>Sed ut perspiciatis unde omnis iste natus error sit </p>
                                                </span>
                                            </a>
                                            <a class="dropdown-item" href="#">
                                                <img src="~/images/recent-paitent-img-2.png" alt="">
                                                <span class="noti-text">
                                                    <h6>Crestina pride</h6>
                                                    <p>Sed ut perspiciatis unde omnis iste natus error sit </p>
                                                </span>
                                            </a>
                                        </div>
                                    </div>
                                    <a href="#!" class="view-all-btn">View All</a>
                                </div>



                            </div>
                            <div class="nav-item dropdown">
                                <a class="user" id="userDropdown" data-toggle="dropdown" aria-haspopup="true"
                                   aria-expanded="false">
                                    @if (Request.Cookies["userimage"] != null && Request.Cookies["userimage"].Value != "")
                                    {
                                        <img src="~/Files/@Request.Cookies["userimage"].Value" width="45px" height="45px" alt="user img">
                                    }
                                    else
                                    {
                                        <img src="/images/avatar.png" width="45px" height="45px" alt="user img">
                                    }

                                    <span class="user-text">@FormsAuthentication.Decrypt(Request.Cookies[FormsAuthentication.FormsCookieName].Value).Name</span>
                                    <i class="fas fa-chevron-down"></i>

                                </a>

                                <div class="dropdown-menu dropdown-user" aria-labelledby="userDropdown">
                                    <ul>
                                        @*@if (Convert.ToString(Session["Roles"]).Contains("Navigator") || Convert.ToString(Session["Roles"]).Contains("Supervisor"))
                                        {
                                            <li><a href="/Account/Settings"><i class="fas fa-users-cog"></i> System Setting</a></li>

                                        }*@
                                        <li><a href="/Account/UserDetails?username=@FormsAuthentication.Decrypt(Request.Cookies[FormsAuthentication.FormsCookieName].Value).Name"><i class="fas fa-users-cog"></i> Profile</a></li>

                                        <li><a href="/Account/Logout"><i class="fas fa-sign-in-alt"></i> Log Out</a></li>
                                    </ul>
                                </div>


                            </div>

                        </div>


                    </ul>

                </div>
            </nav>
        </header>
        <!-- Header end here  -->
        <!-- Sidebar start here  -->
        <aside class="sidebar-menu sidebar-res scroll">
            <a href="/DashBoard/Display" class="logo">
                <img class="img-fluid" src="~/images/logo.png" alt="">
            </a>
            <ul>
                <li id="HomeNavItem"><a href="/DashBoard/Display" id="DashBoard" class="nav-menu"><span class="home-icon"></span> Home </a></li>
                @if (modulePermissions.Where(x => x.ModuleName == "Appointment" && (x.CanList == true || x.CanUpdate == true || x.CanCreate == true || x.CanDelete == true)).Any())
                {
                    <li id="AppointmentNavItem"><a href="/Patient/Appointment" id="Appointment" class="nav-menu"><span class="app-icon"></span> Appointment</a></li>
                }
                @if (modulePermissions.Where(x => x.ModuleName == "Client" && (x.CanList == true || x.CanUpdate == true || x.CanCreate == true || x.CanDelete == true)).Any())
                {
                    <li id="ClientNavItem"><a href="/Patient/List" id="Patient" class="nav-menu"><span class="patient-icon"></span> Clients</a></li>
                }
                @if (modulePermissions.Where(x => x.ModuleName == "Client" && x.CanCreate == true).Any())
                {
                    <li id="AddClientNavItem"><a href="/Client/Add" id="Add" class="nav-menu"><span class="add-icon"></span> Add Client</a></li>
                }
                @if (modulePermissions.Where(x => x.ModuleName == "Notes Template" && (x.CanList == true || x.CanUpdate == true || x.CanCreate == true || x.CanDelete == true)).Any())
                {
                    <li id="NoteTemplateNavItem"><a href="/Patient/NotesTemplateField" id="Add" class="nav-menu"><span class="notes-icon"></span> Notes Template</a></li>
                }
                @if (modulePermissions.Where(x => x.ModuleName == "Authorization" && x.CanList == true).Any())
                {
                    <li id="AuthorizationNavItem"><a href="/Patient/Authorization" id="Authorization" class="nav-menu"><span class="authorization-icon"></span>Authorization</a></li>
                }
                @if (modulePermissions.Where(x => x.ModuleName == "Users" && (x.CanList == true || x.CanUpdate == true || x.CanCreate == true || x.CanDelete == true)).Any())
                {
                    <li id="UsersNavItem"><a href="/Account/Index" id="Account" class="nav-menu"><span class="account-icon"></span>Users</a></li>
                }
                @if (modulePermissions.Where(x => x.ModuleName == "User Group" && (x.CanList == true || x.CanUpdate == true || x.CanCreate == true || x.CanDelete == true)).Any())
                {
                    <li id="UserGroupNavItem"><a href="/Account/UserGroupList" id="UserGroup" class="nav-menu"><span class="group-icon"></span> User Group</a></li>
                }
                @if (modulePermissions.Where(x => x.ModuleName == "Roles/Permission" && (x.CanList == true || x.CanUpdate == true || x.CanCreate == true || x.CanDelete == true)).Any())
                {
                    <li id="RolesNavItem"><a href="/Account/Roles" id="Account" class="nav-menu"><span class="user-role-icon"></span>Roles</a></li>
                }

                <li id="MyAccountNavItem"><a href="/Account/UserDetails?username=@FormsAuthentication.Decrypt(Request.Cookies[FormsAuthentication.FormsCookieName].Value).Name" id="Account" class="nav-menu"><span class="account-icon"></span> My Account</a></li>
                @*<li id="LookUpTableNavItem"><a href="/Patient/WebGridShowLookUpOption" id="LookUpOption" class="nav-menu"><span class="lookup-icon"></span>LookUpTable</a></li>*@

                @if (modulePermissions.Where(x => x.ModuleName == "Form Scheduling" && (x.CanList == true || x.CanUpdate == true)).Any())
                {
                    <li id="FormSchedulingNavItem"><a href="/Patient/FormScheduling" id="FormScheduling" class="nav-menu"><span class="form-sched-icon"></span> Form Scheduling</a></li>
                }
                @if (modulePermissions.Where(x => x.ModuleName == "Potential Client" && (x.CanList == true || x.CanUpdate == true || x.CanDelete == true|| x.CanMove == true)).Any())
                {
                    <li id="PotentialClientNavItem"><a href="/Patient/GetPotientialPatient" id="PotientPatient" class="nav-menu"><span class="add-icon"></span> Potential Clients</a></li>
                }
                @if (modulePermissions.Where(x => x.ModuleName == "Appointment Setting" && (x.CanList == true || x.CanUpdate == true || x.CanCreate == true || x.CanDelete == true)).Any())
                {
                    <li id="AppointmentSettingsNavItem"><a href="/Patient/AppointmentSetting" id="appointmentSettings" class="nav-menu"><span class="sett-icon"></span> Appointment Settings</a></li>
                }
                @if (modulePermissions.Where(x => x.ModuleName == "Careplan Template" && (x.CanList == true || x.CanUpdate == true || x.CanCreate == true || x.CanDelete == true)).Any())
                {
                    <li id="CarePlanNavItem"><a href="/careplan/list" id="careform" class="nav-menu"><span class="careplan-icon"></span> Care Plan Templates</a></li>
                }
                @if (modulePermissions.Where(x => x.ModuleName == "Programs" && (x.CanList == true || x.CanUpdate == true || x.CanCreate == true || x.CanDelete == true)).Any())
                {
                    <li id="ProgramsNavItem"><a href="/program/list" id="programform" class="nav-menu"><span class="program-icon"></span> Programs</a></li>
                }
                @if (modulePermissions.Where(x => x.ModuleName == "Client Forms" && (x.CanList == true || x.CanUpdate == true || x.CanCreate == true || x.CanDelete == true)).Any())
                {
                    <li id="ClientFormsNavItem"><a href="/Client/ClientsFormList" id="ClientsForm" class="nav-menu"><span class="patient-icon"></span> Clients Forms</a></li>
                }
              
                    <li id="CarePlanRequestNavItem" class="@(Convert.ToBoolean(@Session["IsCarePlanApprover"]) ? "" : "d-none")"><a href="/CarePlan/Requests" id="requests" class="nav-menu"><span class="program-icon"></span> Care Plan Requests</a></li>
                
                    @if (modulePermissions.Where(x => x.ModuleName == "Client Request Intake" && (x.CanList == true || x.CanUpdate == true)).Any())
                    {
                        <li id="FormsSharinigNavItem" class="@(Convert.ToString(Session["Roles"]).Contains("Navigator") || Convert.ToString(Session["Roles"]).Contains("Supervisor") ? "" : "d-none")">
                            <a id="formSharing" class="nav-menu" onclick="ResetFormSharingPopup();"><span class="patient-icon"></span>Form Sharing</a>
                        </li>
                    }
                    @if (modulePermissions.Where(x => x.ModuleName == "Form Sharing Export" && x.CanList == true).Any())
                    {
                        <li id="SharedFormExport" class="@(Convert.ToString(Session["Roles"]).Contains("Supervisor") ? "" : "d-none")">
                            <a class="nav-menu" onclick="ExportSharedForms();"><span class="patient-icon"></span>Form Sharing Export</a>
                        </li>
                    }

                    @if ((Convert.ToString(Session["Roles"]).Contains("Navigator") || Convert.ToString(Session["Roles"]).Contains("Supervisor")) && modulePermissions.Where(x => x.ModuleName == "System Setting" && (x.CanList == true || x.CanUpdate == true)).Any())
                    {
                        <li id="AccountSettingNavItem"><a class="nav-menu" href="/Account/Settings"><span class="fas fa-users-cog"></span> System Setting</a></li>

                    }
                    <li><a href="/Account/Logout" id="logout" class="nav-menu"><span class="logout-icon"></span>Log Out</a></li>
                </ul>
        </aside>
        <!-- Sidebar end here  -->
        @RenderBody()

    </div>
    @*<div class="modal fade" id="selectDateAndShare" role="dialog">
        <div class="modal-dialog modal-dialog-centered" role="document" style="max-width:420px; width:100%;">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Expiration Date</h5>
                    <div class="ml-auto">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Select Date (optional)</label>
                        <input type="text" autocomplete="off" id="FormShareExpirydate" class="form-control" placeholder="DD/MM/YYYY" />
                    </div>
                    <div class="text-right">
                        <button type="button" class="btn btn-success" onclick="ShareForm()">Share</button>
                    </div>
                </div>
            </div>
        </div>
    </div>*@

    <div class="modal fade" id="downloadingFormShare" role="dialog">
        <div class="modal-dialog modal-dialog-centered" role="document" style="max-width:420px; width:100%;">
            <div class="modal-content">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" >
                    <span aria-hidden="true">×</span>
                </button>
                <div class="modal-body">
                    <div class="downoadingModalContent">
                        <div class="d_m_icon"><img src="~/images/excel.png" alt="excel" /></div>
                        <div class="downloadingtext">Thanks! Your file is being downloaded..</div>
                        <div class="downloadCompleteText" style="display:none"><i class="fa fa-check-circle"></i> Thanks! download completed</div>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <div class="modal fade" id="formSharingModal" role="dialog">
        <div class="modal-dialog modal-dialog-centered" role="document" style="max-width:56%">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Share Forms</h5>
                    <div class="ml-auto">
                        <a href="javascript:{}"  class="btn btn-success d-none" id="CopyUrlLink">Copy URL Link</a>
                        @if (modulePermissions.Where(x=> x.ModuleName =="Client Request Intake" && x.CanUpdate == true).Any()) {
                        <a href="javascript:{}"class="btn btn-success  disabled" id="ShareForm" onclick="ShareForm()">Share Form</a>
                        }
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="copyLinkText d-none">Form URL Link:- <span></span></div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Client name</label>
                                <div class="searchbox">
                                    <button class="formsharesearchbtn" type="submit"><i class="fas fa-search"></i></button>
                                    <input type="text" placeholder="Search..." data-val="0" id="ddClientlistforsharing" autocomplete="off">
                                    <div class="searchboxDropDown">
                                        <div class="scroll">
                                            <ul id="shareFormpatientList">
                                                <li>
                                                    <div class="imagebox">
                                                        <img src="~/images/recent-paitent-img.png" alt="">
                                                    </div>
                                                    <div class="searchDeatails">
                                                        <span>Name: John</span>
                                                        <span>Email: John@gmail.com</span>
                                                        <span>SSN: 45896325</span>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>



                                @*<select class="form-control" style="display:block!important" id="ddClientlistforsharing" data-live-search="true" title="Select" onchange="GetUserListandHistory()"></select>*@
                            </div>
                        </div>

                    </div>

                    <div class="rounded_tabs_list">
                        <ul class="nav nav-tabs" role="tablist">
                            <li class="nav-item"><a class="nav-link active" onclick="LoadUserListShareFormOnTabClick()" href="#selectClientTab">Select Form</a></li>
                            <li class="nav-item"><a class="nav-link" onclick="LoadHistoryShareFormOnTabClick()" href="#sharedStatusTab">Shared Status</a></li>
                        </ul>
                        <div class="tab-content">
                            <div id="selectClientTab" class="tab-pane fade  active show">
                                <div class="data_content">
                                    <table class="table dataTable no-footer members_list_table c_table" id="ShareformUserList">
                                        <thead>
                                            <tr role="row" style="height: 0px;">
                                                <th>
                                                    <div class="dataTables_sizing">
                                                        <label class="input_checkbox">
                                                            <input type="checkbox" id="SelectShareFormUser_All" name="SelectAllUsers" onchange="SelectedOrDeselectAllUsers(this)" value="select all">
                                                            <span></span>
                                                        </label>
                                                    </div>
                                                </th>
                                                <th>
                                                    <div class="dataTables_sizing">Name</div>
                                                </th>
                                            </tr>
                                        </thead>

                                        <tbody></tbody>
                                    </table>
                                </div>
                                <div class="NoFormSelectedMessage">Please select a client</div>

                            </div>
                            <div id="sharedStatusTab" class="tab-pane fade">
                                <div class="data_content d-none">
                                    <div class="row justify-content-end">
                                        <div class="form-group col-lg-3"><h6 class="t_filter_head text-right">Filters</h6></div>
                                        <div class="form-group col-lg-3">
                                            <label>Form Name</label>
                                            <select class="form-control" id="ddFormNameShareHistory" onchange="GetFormSharingHistory()"></select>
                                        </div>
                                        <div class="form-group col-lg-3" ">
                                            <label>Status</label>
                                            <select class="form-control" id="ddStatusShareHistory" onchange="GetFormSharingHistory()">
                                                <option value="-1">Select</option>
                                                <option value="0">NotStarted</option>
                                                <option value="1">Viewed</option>
                                                <option value="2">Completed</option>
                                                <option value="3">Expired</option>
                                            </select>
                                        </div>
                                    </div>

                                    <table class="table dataTable c_table no-footer members_list_table " id="SharedformHistory">
                                        <thead>
                                            <tr role="row" style="height: 0px;">
                                                <th>Form name</th>
                                                <th>Status</th>
                                                <th>Sent On</th>
                                                <th>Last viewed</th>
                                                <th>Last remind</th>
                                                <th>Expiration Date</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>

                                        <tbody></tbody>
                                    </table>
                                </div>
                                <div class="NoFormSelectedMessage">Please select a client</div>

                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>


    <script type="text/javascript">


                        var $OverlayLoader = $('.loaderOverlay')
                        var _Loader = {
                            StartLoader: function () {
                                $OverlayLoader.css('display','flex')
                            },
                            StopLoader: function () {
                                $OverlayLoader.hide()
                            }
                        }



        $('#formSharingModal .nav-tabs li > a').on('click', function (e) {
            e.preventDefault()
            $(this).tab('show')
        })
        var Apipath = '@System.Configuration.ConfigurationManager.AppSettings["WebApi"]';
                        var SeperationString = '#$%^*'
                        var _shareFormClinicId='@Session["ClinicID"]'
        function RedirectPatient(ID) {

            window.location = '/Client/Info?patientid=' + ID;
        }

                        $(document).ready(function () {
                            HighLightMenu()
                        })



        $(document).click(function (e) {
           
            if (e.target.id != 'patientList') {
                $("#searchPatient").val('');
                $NavbarSupportedContent.find(".searchboxDropDown").css('display', 'none');
            }


            if (e.target.id != 'ddClientlistforsharing') {
                $DDclientlistforsharing.val(shareFormClientValue);
                $FormSharingModal.find(".searchboxDropDown").css('display', 'none');
            }

        });

        function getTitle(title) {

            if (title.length > 0) {
                return title.text();
            } else {
                return ''
            }
        }

        function isNumber(evt) {
            evt = (evt) ? evt : window.event;
            var charCode = (evt.which) ? evt.which : evt.keyCode;
            if (charCode > 31 && (charCode < 48 || charCode > 57)) {
                return false;
            }
            return true;
        }
        var SearchRequest=null
        function SearchPatient() {

            var keyword = $("#searchPatient").val();
            if (SearchRequest != null) {
                SearchRequest.abort()
            }
            SearchRequest=  $.ajax({
                type: "GET",
                url: Apipath + '/api/PatientMain/SearchPatient?keyword=' + keyword + '&clinicid=' + _shareFormClinicId,
                contentType: 'application/json; charset=UTF-8',
                dataType: "json",
                success: function (result) {

                    if (result.length) {
                        $("#patientList").html('');
                        var tbl = '';
                        for (var i = 0; i < result.length; i++) {
                            if (result[i].EmailAddress == null) { result[i].EmailAddress = ''; }
                            if (result[i].SocialSecurityNumber == null) { result[i].SocialSecurityNumber = ''; }


                            tbl += '<li style="cursor: pointer;" onclick="RedirectPatient(' + result[i].PatientID + ')">'
                            if (result[i].PatientImg == '' || result[i].PatientImg ==null) {
                                tbl += '<div class="imagebox"><img src="/images/avatar.png" alt=""> </div>'
                            } else {
                                tbl += '<div class="imagebox"><img src="/Files/' + result[i].PatientImg + '" alt=""> </div>'
                            }
                            tbl += '<div class="searchDeatails">'
                            tbl += '<span>Name:' + result[i].FirstName + ' ' + result[i].MiddleName + ' ' + result[i].LastName + '</span >'

                            tbl += '<span>Phone No.: ' + result[i].HomePhone + '</span >'
                            tbl += '<span>City: ' + result[i].City + '</span > </div> </li>'


                        }
                        $NavbarSupportedContent.find(".searchboxDropDown").css('display', 'block');
                        $("#patientList").html(tbl);




                    } else {
                        $NavbarSupportedContent.find(".searchboxDropDown").css('display', 'none');
                    }


                },
                error: function () {

                 //   toastr.error("Error while checking record");
                }
            });
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="~/Scripts/bootstrap.min.js"></script>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>

    <script src="~/Scripts/bootstrap_multiselect.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.15/datatables.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.3/toastr.min.js" integrity="sha512-lbwH47l/tPXJYG9AcFNoJaTMhGvYWhVM9YI43CT+uteTRRaiLCui8snIgyAN8XWgNjNhCqlAUdzZptso6OCoFQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    @*<script src="~/Scripts/toastr.min.js"></script>*@

    @*<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>*@
    @*<script src="~/Scripts/bootstrap_multiselect.js"></script>*@

    <script src="~/Scripts/moment.min.js"></script>
    <script src="~/Scripts/fullcalendar.min.js"></script>
    @*<script src="https://cdn.rawgit.com/atatanasov/gijgo/master/dist/combined/js/gijgo.min.js" type="text/javascript"></script>*@
    <script src="~/Scripts/select2.min.js"></script>
    <script src="~/Scripts/jquery.mask.js"></script>


    <script type="text/javascript">
        var CanEditShareForm = '@modulePermissions.Where(x => x.ModuleName == "Client Request Intake" && x.CanUpdate == true).Any()'
        var $DDclientlistforsharing = $('#ddClientlistforsharing');
        var $FormSharingModal = $('#formSharingModal')
        var $ShareformUserList = $('#ShareformUserList')
        var $ShareformHistoryTable = $('#SharedformHistory')
        var $SelectShareFormUserAll = $('#SelectShareFormUser_All')
        var $ShareFormbtn = $('#ShareForm');
        var isUserListLoaded = false
        var isSharedHistoryStatusLoaded = false
        var $DDFormNameShareHistory = $('#ddFormNameShareHistory')
        var $DDStatusShareHistory = $('#ddStatusShareHistory')
        var $FormShareExpirydate = $('#FormShareExpirydate')
        var $selectDateAndShare = $('#selectDateAndShare')
        var $NoFormSelectedMessage = $('.NoFormSelectedMessage')
        var $ShareFormpatientList = $('#shareFormpatientList')
        var $NavbarSupportedContent = $('#navbarSupportedContent')
        var $DownloadingFormShare = $('#downloadingFormShare');
        var $CopyUrlLink= $('#CopyUrlLink');
        var $CopyLinkText = $('.copyLinkText');
       
        setTimeout(function () {
            $FormShareExpirydate.datepicker(
                {
                    changeYear: true,
                    changeMonth: true,
                    minDate: '+1d'
                }
            );
        }, 2000)



        $('a.nav-menu1').click(function () {
            if ($(".sidebar-menu").hasClass("sidebar-res")) {
                $('.sidebar-menu').removeClass('sidebar-res');
                $('#content').removeClass('responsive-container');

            } else {
                $('.sidebar-menu').addClass('sidebar-res');
                $('#content').addClass('responsive-container');
            }
        })

        $('.selectboxmultiple').selectpicker();
        $('.select2').select2({ placeholder: "Select Client", allowClear: true, searchInputPlaceholder: 'Search ...' });

                        function hash(str) {
                            var hash = 0, i, chr;
                            if (str.length === 0) return hash;
                            for (i = 0; i < str.length; i++) {
                                chr = str.charCodeAt(i);
                                hash = ((hash << 5) - hash) + chr;
                                hash |= 0;
                            }
                            if (hash < 0) {
                                return -1 * hash
                            }
                            return hash;
                        }
                        function shortenColName(colname) {
                            if (colname.length > 128) {
                                let firstSub = colname.substring(0, 100);
                                let lastSub = colname.substring(100, colname.length);
                                let generatedHash = hash(lastSub);
                                colname = firstSub + generatedHash;
                            }
                            return colname
                        }
                      
                        function HighLightMenu() {

                            var Path = window.location.pathname
                            switch (Path) {
                                case "/DashBoard/Display":
                                    $('#HomeNavItem').addClass('active')
                                    break;
                                case "/Patient/Appointment":
                                    $('#AppointmentNavItem').addClass('active')
                                    ScrollFunction('#AppointmentNavItem')

                                    break;
                                case "/Patient/List":
                                    $('#ClientNavItem').addClass('active')
                                    ScrollFunction('#ClientNavItem')
                                    break;

                                case "/Client/Add":
                                    $('#AddClientNavItem').addClass('active')
                                    ScrollFunction('#AddClientNavItem')

                    break;
                case "/Patient/NotesTemplateField":
                    $('#NoteTemplateNavItem').addClass('active')
                    ScrollFunction('#NoteTemplateNavItem')
                    break;
                case "/Patient/Authorization":
                    $('#AuthorizationNavItem').addClass('active')
                    ScrollFunction('#AuthorizationNavItem')
                    break;
                case "/Account/Index":
                    $('#UsersNavItem').addClass('active')
                    ScrollFunction('#UsersNavItem')
                    break;
                case "/Account/UserGroupList":
                    $('#UserGroupNavItem').addClass('active')
                    ScrollFunction('#UserGroupNavItem')
                    break;
                case "/Account/Roles":
                    $('#RolesNavItem').addClass('active')
                    ScrollFunction('#RolesNavItem')
                    break;
                case "/Account/UserDetails":
                    $('#MyAccountNavItem').addClass('active')
                    ScrollFunction('#MyAccountNavItem')
                    break;
                case "/Patient/WebGridShowLookUpOption":
                    $('#LookUpTableNavItem').addClass('active')
                    ScrollFunction('#LookUpTableNavItem')

                    break;


                case "/Patient/FormScheduling":
                    $('#FormSchedulingNavItem').addClass('active')
                    ScrollFunction('#FormSchedulingNavItem')

                    break;
                case "/Patient/GetPotientialPatient":
                    $('#PotentialClientNavItem').addClass('active')
                    ScrollFunction('#PotentialClientNavItem')

                    break;
                case "/Patient/AppointmentSetting":
                    $('#AppointmentSettingsNavItem').addClass('active')
                    ScrollFunction('#AppointmentSettingsNavItem')
                    break;
                case "/careplan/list":
                    $('#CarePlanNavItem').addClass('active')
                    ScrollFunction('#CarePlanNavItem')
                    break;

                case "/program/list":
                    $('#ProgramsNavItem').addClass('active')
                    ScrollFunction('#ProgramsNavItem')
                    break;
                case "/CarePlan/Requests":
                    $('#CarePlanRequestNavItem').addClass('active')
                    ScrollFunction('#CarePlanRequestNavItem')
                    break;
                case "/Client/ClientsFormList":
                    $('#ClientFormsNavItem').addClass('active')
                    ScrollFunction('#ClientFormsNavItem')
                                    break;
                   case "/Account/Settings":
                     $('#AccountSettingNavItem').addClass('active')
                     ScrollFunction('#AccountSettingNavItem')
                    break;
            }

        }

                        function ScrollFunction(item) {
                            setTimeout(function () {
                                var scrollViewHeight = $('.sidebar-menu').height() / 2;
                                var navBarHeight = $('.navbar').height();
                                $('.sidebar-menu').scrollTop($(item).offset().top - navBarHeight - scrollViewHeight);
                               
                            }, 500)
                        }



        function OpenFormHistory(formId, ClientId, isClientForm = false) {
            $.ajax({
                type: "Get",
                url: '/Client/GetFormLogHistory?formId=' + formId + '&&clientid=' + ClientId + '&&isClientForm=' + isClientForm,
                dataType: "html",
                contentType: "application/json; charset=utf-8",
                success: function (result) {
                    var $FormHistory = $('#FormLogHistory')
                    $FormHistory.modal('show');
                    $FormHistory.find('.modal-body').html(result)
                    var $HistoryLogTable = $('#historyFormLogTable')
                    $HistoryLogTable.DataTable({
                        "searching": false,
                        "ordering": false,
                        "paging": false
                    });

                },
                error: function () {
                    toastr.error("Some error occurred!! or data not found");
                },
                complete: function () {
                    $(".scroll").animate({ scrollTop: 0 }, "slow");
                    _Loader.StopLoader()
                }
            });

        }

        function ResetFormSharingPopup() {
            $RightSidebar = $('.profile-tabs #menu-toggle')
            if ($RightSidebar.hasClass('open')) {
                $RightSidebar.click();
            }


            formShareUserList = [];
            if (formShareHistoryTable != '' && formShareHistoryTable != undefined) {
                formShareHistoryTable.clear();
                formShareHistoryTable.destroy();
                formShareHistoryTable = ''
            }
            if (formSharingUserListTable != '' && formSharingUserListTable != undefined) {
                formSharingUserListTable.clear();
                formSharingUserListTable.destroy();
                formSharingUserListTable = ''
            }
            isUserListLoaded = false;
            isSharedHistoryStatusLoaded = false
            $DDStatusShareHistory.val("-1");
            $DDFormNameShareHistory.html('')
            $ShareformHistoryTable.find('tbody').html('')
            $ShareformUserList.find('tbody').html('')
            $SelectShareFormUserAll.prop('checked', false)
            $ShareFormbtn.addClass('disabled')
            HideShareFormtabsContent('#selectClientTab')
            HideShareFormtabsContent('#sharedStatusTab')

            $NoFormSelectedMessage.removeClass('d-none');
            $ShareFormpatientList.html('')
            $DDclientlistforsharing.val('')
            shareFormClientId = 0;
            shareFormClientValue = ''
            $CopyUrlLink.attr('onclick', '')
            $CopyUrlLink.addClass('d-none')
            $FormSharingModal.modal('show')
            allClientList = [];
            filteredClients = []
            GetAllClient()
        }



        var formShareFormList = []
        function SelectedOrDeselectAllUsers(CheckBox) {
            formShareFormList = [];
            if ($(CheckBox).is(":checked")) {
                $ShareformUserList.find('input[name="formShareUserSelectedCheckBox"]').each(function () {
                    $(this).prop('checked', true);
                    formShareFormList.push($(this).val())
                })
            }
            else {
                $ShareformUserList.find('input[name="formShareUserSelectedCheckBox"]').each(function () {
                    $(this).prop('checked', false);
                })
            }
            EnableDisableShareButton()

        }

        function EnableDisableShareButton() {

            if (formShareFormList.length == 0) {
                $ShareFormbtn.addClass('disabled')
                $SelectShareFormUserAll.prop('checked', false)
            } else {
                $ShareFormbtn.removeClass('disabled')
            }

        }

        function SelectFormShareUser(item) {

            var value = $(item).val()
            if ($(item).is(":checked")) {
                if (formShareFormList.indexOf(value) == -1) {
                    formShareFormList.push(value);
                }

            } else {
                var index = formShareFormList.indexOf(value)
                if (index != -1) {
                    formShareFormList.splice(index, 1);
                }
                $SelectShareFormUserAll.prop('checked', false);
            }
            EnableDisableShareButton()
        }

        function GetShareTabClientDropDown() {
            _Loader.StartLoader()
            var clientId = shareFormClientId;
            $.ajax({
                type: "Get",
                url: Apipath + '/api/PatientMain/getformsListForHistoryTab?clientid=' + clientId,
                dataType: "Json",
                contentType: "application/json; charset=utf-8",
                success: function (result) {
                    var html;
                    html += `<option value="0">Select</option>`
                    if (result) {

                        for (var i = 0; i < result.length; i++) {
                            html += `<option value="${result[i].FormId}">${result[i].FormName}</option>`
                        }
                    }
                    $DDFormNameShareHistory.html(html)

                },
                error: function () {
                    _Loader.StopLoader()
                    toastr.error("Some error occurred!! or data not found");
                },
                complete: function () {

                    GetFormSharingHistory();

                }
            });

        }
        var shareFormClientId = 0;
        var shareFormClientValue = ''

        $DDclientlistforsharing.click(function (e) {

            var value = $(this).val()
            if (value.trim() == '') {
                GetClientsForSharing()
            }
            isVisible = $FormSharingModal.find(".searchboxDropDown").is(':visible')
            if (isVisible) {
                $DDclientlistforsharing.val(shareFormClientValue);
                $FormSharingModal.find(".searchboxDropDown").css('display', 'none');
            }
            else {
                $FormSharingModal.find(".searchboxDropDown").css('display', 'block');
            }

        })

        $DDclientlistforsharing.keyup(function () {

            GetClientsForSharing();
            $FormSharingModal.find(".searchboxDropDown").css('display', 'block');
        })

        var _UniqueLoader;
        function GetUniqueUrl(clientId) {

            
            $.ajax({
                type: "Get",
                url: Apipath + '/api/PatientMain/getuniqueurl?clinicid=' + clientId,
                dataType: "Json",
                contentType: "application/json; charset=utf-8",
                beforeSend: function () {
                    _UniqueLoader = _Loader.StartLoader();
                },
                success: function (result) {
                    if (result.length) {
                        $CopyUrlLink.attr('onclick', "CopyUrlLink('" + result + "')")
                        $CopyUrlLink.removeClass('d-none')
                        $CopyLinkText.removeClass('d-none')
                        $CopyLinkText.find('span').text(result)
                    } else {
                        $CopyUrlLink.attr('onclick', '')
                        $CopyUrlLink.addClass('d-none')
                        $CopyLinkText.addClass('d-none')
                        $CopyLinkText.find('span').text("")
                    }
                },
                error: function () {
                    _Loader.StopLoader()
                },
                complete: function () {

                    _Loader.StopLoader()

                }
            });

        }



        function SelectFormShareClient(clientid, ClientName, ClientMail) {
            shareFormClientId = clientid
            shareFormClientValue = ClientName
            GetUniqueUrl(clientid);
            $DDclientlistforsharing.val(ClientName);
            GetClientsForSharing(ClientMail)
            GetUserListandHistory()
        }

        var ShareFormSearchRequest = null;
        var allClientList = [];
        var filteredClients = []


        function GetAllClient() {

            _Loader.StartLoader()
            $.ajax({
                type: "Get",
                url: Apipath + '/api/PatientMain/getclientsforSharing?clinicid=' + _shareFormClinicId,
                dataType: "Json",
                contentType: "application/json; charset=utf-8",
                success: function (result) {
                    if (result.length) {
                        allClientList = result;
                    }
                },
                error: function () {
                    _Loader.StopLoader()
                },
                complete: function () {

                    _Loader.StopLoader()

                }
            });



        }

        function GetClientsForSharing(email = '') {
            if (ShareFormSearchRequest != null) {
                ShareFormSearchRequest.abort()
            }
            var keyword = ''
            if (email != '') {
                keyword = email
            } else {
                keyword = $DDclientlistforsharing.val();
            }

            if (keyword != null) {
                keyword = keyword.trim()
            }
            keyword = keyword.toLowerCase()

            filteredClients = allClientList.filter(c => {

                if (c.DisplayName.toLowerCase().indexOf(keyword) > -1 || c.UserEmail.toLowerCase().indexOf(keyword) > -1) {
                    return true;
                } else {
                    return false;
                }

            })

            if (filteredClients.length) {

                var result = filteredClients;

                $ShareFormpatientList.html('');
                var tbl = '';
                for (var i = 0; i < result.length; i++) {
                    if (result[i].UserEmail == null) { result[i].UserEmail = ''; }
                    if (result[i].SocialSecurityNumber == null) { result[i].SocialSecurityNumber = ''; }


                    tbl += `<li style="cursor: pointer;" onclick="SelectFormShareClient(${result[i].UserId} , '${result[i].DisplayName}','${result[i].UserEmail}')">`
                    if (result[i].Image == '' || result[i].Image == null) {
                        tbl += '<div class="imagebox"><img src="/images/avatar.png" alt=""> </div>'
                    } else {
                        tbl += '<div class="imagebox"><img src="/Files/' + result[i].Image + '" alt=""> </div>'
                    }
                    tbl += '<div class="searchDeatails">'
                    tbl += '<span>Name:' + result[i].DisplayName + '</span >'
                    tbl += '<span>Email Address:' + result[i].UserEmail + '</span >'

                    tbl += '<span>Phone No.: ' + result[i].HomePhone + '</span >'
                    tbl += '<span>City: ' + result[i].City + '</span > </div> </li>'


                }
                $ShareFormpatientList.html(tbl);
            }

        }



        function GetUserListandHistory() {

            if (HideTabsOnFormSelect()) {
                return;
            }
            $DDStatusShareHistory.val('-1')
            isUserListLoaded = false
            isSharedHistoryStatusLoaded = false;

            formShareFormList = [];
            EnableDisableShareButton();
            if ($('#selectClientTab').hasClass('active')) {
                GetFormListForFormSharing();
                isUserListLoaded = true
                HideShareFormtabsContent('#sharedStatusTab')
            } else {
                GetShareTabClientDropDown();
                isSharedHistoryStatusLoaded = true;
                HideShareFormtabsContent('#selectClientTab')
            }
            //$FormSharingModal.find('.rounded_tabs_list .tab-content .tab-pane').removeClass('d-none')
        }

        var formShareHistoryTable;
        function GetFormSharingHistory() {
            if (!$OverlayLoader.is(":visible")) {
                _Loader.StartLoader()

            }

            var formId, statusid, clientid;
            formId = $DDFormNameShareHistory.val();
            statusid = $DDStatusShareHistory.val();
            clientid = shareFormClientId;


            $.ajax({
                type: "Get",
                url: Apipath + '/api/PatientMain/getformsharinghistory?formid=' + formId + '&statusid=' + statusid + '&clientid=' + clientid,
                dataType: "Json",
                contentType: "application/json; charset=utf-8",
                success: function (result) {
                    var $SharedformHistoryTbody = $('#SharedformHistory tbody');
                    var html = '';
                    if (formShareHistoryTable != '' && formShareHistoryTable != undefined) {
                        formShareHistoryTable.clear();
                        formShareHistoryTable.destroy();
                    }
                    
                    for (var i = 0; i < result.length; i++) {
                        html += ` <tr>
                                                                  <td style="width:14%">${result[i].FormName != null ? result[i].FormName : ''}</td>
                                                                   <td style="width:10%">${result[i].Status}</td>
                                                                   <td style="width:17%">${FormatDate(result[i].SentOn)}</td>
                                                                   <td style="width:17%">${FormatDate(result[i].LastViewedOn)}</td>
                                                                   <td style="width:17%">${FormatDate(result[i].LastRemindedOn)}</td>
                                                                   <td style="width:17%">${FormatDate(result[i].ExpiryDate, false)}</td>
                                                                   <td style="width:10%"><div class="d-flex">`
                       // html += `<button class="btn btn-success text-white" onclick="CopyUrlLink('${result[i].Url}')" style="cursor:pointer;">Copy URL Link</button>`
                        if (result[i].IsExpired == 0 && result[i].Status != 'Completed' && CanEditShareForm == 'True') {
                            html += ` <button class="btn btn-success text-white" onclick="SendReminder(${result[i].ShareId})" style="cursor:pointer;">Remind</button>`
                        }
                        html += ` </div></td></tr>`
                    }
                    
                    if (result.length == 0) {
                        html = `<tr><td></td><td></td><td></td><td>No history Available</td><td></td><td></td><td></td></tr>`
                    }
                    $SharedformHistoryTbody.html(html)
                    ShowShareFormtabsContent('#sharedStatusTab')
                    formShareHistoryTable = $('#SharedformHistory').DataTable({
                        "searching": false,
                        "paging": false,
                        "ordering": false,
                        "scrollY": "130px",
                        'columnDefs': [{
                            'targets': [6],
                            'orderable': false
                        }]

                    });


                },
                error: function () {
                    _Loader.StopLoader()
                    toastr.error("Some error occurred!! or data not found");
                },
                complete: function () {

                    _Loader.StopLoader()

                }
            });

        }

        function CopyUrlLink(Url) {
            navigator.clipboard.writeText(Url);
            toastr.success("Shared form's URL link is copied.")
        }


        function FormatDate(date, includeTimePart = true) {
            if (date == null) {
                return ''
            }
            var formatedDate = new Date(date).toLocaleDateString('en-US')
            if (!includeTimePart) {
                return formatedDate;
            }
            var Timearray = date.split("T")[1].split(":");
            var AmPm = Timearray[0] >= 12 ? 'pm' : 'am';
            var Time = Timearray[0] + ":" + Timearray[1] + ":" + Timearray[2].split(".")[0] + " " + AmPm;

            return formatedDate + ' ' + Time;
        }
        var formSharingUserListTable;
        function LoadUserListShareFormOnTabClick() {
            $NoFormSelectedMessage.addClass('d-none')
            if (HideTabsOnFormSelect()) {
                return;
            }

            HideShareFormtabsContent('#sharedStatusTab')
            /* if (!isUserListLoaded) {*/
            setTimeout(function () {
                GetFormListForFormSharing();
                disableShareBtn()
                isUserListLoaded = true
            }, 200)

            //} else {
            //    ShowShareFormtabsContent('#selectClientTab')
            //}

        }

        function disableShareBtn() {
            formShareFormList = [];
            $ShareFormbtn.addClass('disabled')
        }
        function LoadHistoryShareFormOnTabClick() {
            $NoFormSelectedMessage.addClass('d-none')
            if (HideTabsOnFormSelect()) {
                return;
            }
            if (shareFormClientId == '0' || shareFormClientId == '') {
                HideShareFormtabsContent('#selectClientTab')
                HideShareFormtabsContent('#sharedStatusTab')

            }


            HideShareFormtabsContent('#selectClientTab')
            /* if (!isSharedHistoryStatusLoaded) {*/
            setTimeout(function () {
                GetShareTabClientDropDown();
                disableShareBtn()
                isSharedHistoryStatusLoaded = true
            }, 200)

            //} else {
            //    ShowShareFormtabsContent('#sharedStatusTab')
            //}

        }
        function HideTabsOnFormSelect() {

            if (shareFormClientId == '0') {
                HideShareFormtabsContent('#selectClientTab')
                HideShareFormtabsContent('#sharedStatusTab')
                $NoFormSelectedMessage.removeClass('d-none')
                return true;
            } else {
                $NoFormSelectedMessage.addClass('d-none')
                return false;
            }
        }

        function HideShareFormtabsContent(div) {
            $(div).find('.data_content').addClass('d-none')
        }
        function ShowShareFormtabsContent(div) {
            $(div).find('.data_content').removeClass('d-none')
        }

        function ResetExpirationDate() {
            $FormShareExpirydate.datepicker('setDate', null);
        }


        function SendReminder(shareId) {
            _Loader.StartLoader()
            $.ajax({
                type: "POST",
                url: Apipath + '/api/PatientMain/sendRemainderforsharedform?shareid=' + shareId,
                contentType: 'application/json; charset=UTF-8',
                dataType: "json",
                success: function (result) {
                    GetFormSharingHistory();
                    toastr.success("", "Reminder is sent successfully", { progressBar: true });
                },
                error: function () {
                    _Loader.StopLoader()
                    toastr.error("Error while updating goal sort index");
                },
                complete: function () {
                    _Loader.StopLoader()
                }
            });

        }



        function GetFormListForFormSharing() {
            _Loader.StartLoader()
            var clientid = shareFormClientId
            $.ajax({
                type: "Get",
                url: Apipath + '/api/PatientMain/getformlistforformsharing?clientid=' + clientid,
                dataType: "Json",
                contentType: "application/json; charset=utf-8",
                success: function (result) {
                    var ShareformUserListTbody = $('#ShareformUserList tbody')
                    var html = '';
                    if (formSharingUserListTable != '' && formSharingUserListTable != undefined) {
                        formSharingUserListTable.clear();
                        formSharingUserListTable.destroy();
                    }

                    for (var i = 0; i < result.length; i++) {
                        html += ` <tr>
                                                                   <td style="width:30%;">
                                                                      <label class="input_checkbox"><input type="checkbox" onchange="SelectFormShareUser(this)" name="formShareUserSelectedCheckBox" value="${result[i].FormId}"><span></span></label>
                                                                     </td>
                                                                <td style="width:70%;">
                                                                        ${result[i].FormName}
                                                                  </td>
                                                             </tr>`
                    }

                    if (result.length == 0) {
                        html = `<tr><td class="text-center">No form available to share</td><td class="d-none"></td></tr>`
                    }
                    ShareformUserListTbody.html(html)
                    ShowShareFormtabsContent('#selectClientTab')
                    formSharingUserListTable = $ShareformUserList.DataTable({
                        "searching": true,
                        "paging": false,
                        "scrollY": "180px",
                        'columnDefs': [{
                            'targets': [0],
                            'orderable': false
                        }]

                    });


                },
                error: function () {
                    _Loader.StopLoader()
                    toastr.error("Some error occurred!! or data not found");
                },
                complete: function () {

                    _Loader.StopLoader()
                }
            });
        }

        function ShareForm() {
            _Loader.StartLoader()

            var model = {
                FormsIds: formShareFormList,
                ClientId: shareFormClientId
            }

            $.ajax({
                type: "POST",
                url: Apipath + '/api/PatientMain/saveformsharingdetails',
                data: JSON.stringify(model),
                contentType: 'application/json; charset=UTF-8',
                dataType: "json",
                success: function (result) {
                    $selectDateAndShare.modal('hide')
                    // $FormSharingModal.modal('hide')
                    toastr.success("", "Form is shared successfully", { progressBar: true });
                    if ($('#selectClientTab').hasClass('active')) {
                        LoadUserListShareFormOnTabClick()
                    } else {
                        LoadHistoryShareFormOnTabClick()
                    }
                    disableShareBtn()

                },
                error: function () {
                    _Loader.StopLoader()
                    toastr.error("Error while updating goal sort index");
                },
                complete: function () {
                    GetUniqueUrl(shareFormClientId);
                    //  _Loader.StopLoader()
                }
            });
        }


       

        function ExportSharedForms() {
           
            
            $DownloadingFormShare.find('.downloadingtext').show();
            $DownloadingFormShare.find('.downloadCompleteText').hide();
            $DownloadingFormShare.modal('show');
            
            $.ajax({
                type: "Post",
                url: '/Client/GenerateSharedForms',
                dataType: "Json",
                contentType: "application/json; charset=utf-8",
                success: function (result) {
                    if (!result.hasError) {

                        $('#ExportSharedForms_Export').submit();
                        setTimeout(function () {
                            $DownloadingFormShare.find('.downloadingtext').hide();
                            $DownloadingFormShare.find('.downloadCompleteText').show();
                          
                        }, 300);
                    } else {
                        _Loader.StopLoader()
                        toastr.error("There is no data to be exported.");
                    }
                },
                error: function () {
                    toastr.error("Unexpected error!");
                    _Loader.StopLoader()
                }
            });

        }



    </script>


    @RenderSection("scripts", required: false)
</body>
</html>
